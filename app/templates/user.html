{% extends "index.html" %}

{% block left_side %}
<!-- 修改资料窗口 -->
<div id="edit_profile" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <button class="close" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-title">
                <h2 class="text-center">修改个人资料</h2>
            </div>
            <div class="modal-body">
                <form class="form-group" action="/edit-profile" method="post">
                        {{ editprofileform.csrf_token }}
                        <div class="form-group">
                            {{ wtf.form_field(editprofileform.name) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileform.location) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileform.about_me) }}
                        </div>
                        <div class="text-right">
                            {{ wtf.form_field(editprofileform.submit, class="btn btn-primary") }}
                            {{ wtf.form_field(editprofileform.cancel, class="btn btn-danger") }}
                        </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- 修改资料[管理员]窗口 -->
<div id="edit_profile_admin" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <button class="close" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-title">
                <h2 class="text-center">修改个人资料</h2>
            </div>
            <div class="modal-body">
                <form class="form-group" action="/edit-profile/{{ user.id }}" method="post">
                        {{ editprofileform.csrf_token }}
                        <div class="form-group">
                            {{ wtf.form_field(editprofileadminform.email) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileadminform.username) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileadminform.confirmed) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileadminform.role) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileadminform.name) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileadminform.location) }}
                        </div>
                        <div class="form-group">
                            {{ wtf.form_field(editprofileadminform.about_me) }}
                        </div>
                        <div class="text-right">
                            {{ wtf.form_field(editprofileadminform.submit, class="btn btn-primary") }}
                            {{ wtf.form_field(editprofileadminform.cancel, class="btn btn-danger") }}
                        </div>
                </form>
            </div>
        </div>
    </div>
</div>
<h2>用户名：{{ user.username }}</h2>
<hr>
<div class="row">
<div class="col-md-4">
<img class="thumbnail" src="{{ user.gravatar(size=200) }}">
</div>
<div class="col-md-8">

<p>
    所在地址：
    {% if user.name or user.location %}
    {% if user.name %}{{ user.name }}{% endif %}
    {% if user.location %}
        from <a href="http://maps.google.com/?q={{ user.location }}">{{ user.location }}</a>
    {% endif %}
    {% endif %}
</p>

<p>
    邮箱地址：
    {% if current_user.email %}
    <a href="mailto:{{ user.email }}">{{ user.email }}</a>
    {% else %}
    只有用户或者管理员可见
    {% endif %}
</p>

<p>
    职业：
    {% if user.about_me %}{{ user.about_me }}{% endif %}
</p>

<p>
    个人简介：
    {% if user.about_me %}{{ user.about_me }}{% endif %}
</p>
<p>注册于：{{ moment(user.member_since).format('YYYY年MM月DD日') }}   最近登录：{{ moment(user.last_seen).fromNow() }}</p>
<p>
    {% if user == current_user %}
    <!--<a class="btn btn-primary" href="{{ url_for('.edit_profile') }}">Edit Profile</a>-->
    <a data-toggle="modal" data-target="#edit_profile" class="btn btn-primary">修改资料</a>
    {% endif %}
    {% if current_user.is_administrator() %}
    <a data-toggle="modal" data-target="#edit_profile_admin" class="btn btn-danger">修改资料[管理员]</a>
    {% endif %}
</p>
</div>
</div>
<ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#articles">所有文章</a></li>
    <li><a data-toggle="tab" href="#comments">所有评论</a></li>
</ul>
<div id="myTabContent" class="tab-content">
	<div class="tab-pane fade in active" id="articles">
		{% for article in articles %}
            <div class="entry-box">
                <div class="media">
                <div class="media-left" style="position: relative">
                    <a href="/article/{{ article.id }}">
                      <img class="media-object" data-src="holder.js/100x100" alt="100x100" src="/static/cover.jpg">
                    </a>
                    <div style="position:absolute;right:0;bottom:0">
                        <span class="label label-danger">{{ article.articletype.name }}</span>
                        <span class="label label-warning">原创</span>
                    </div>
                </div>
                  <div class="media-body" style="position:relative">
                      <h3 class="media-heading"><a style="text-decoration:none" href="/article/{{ article.id }}">{{ article.title }}</a></h3>
                    <p>{{ article.abstract }}</p>
                    <div style="position:absolute;right:0;bottom:0">
                        <span style="margin-right: 20px"><i class="fa fa-calendar" aria-hidden="true"></i>  {{ moment(article.timestamp).fromNow() }}</span>
                        <span class="label label-primary" style="margin-right: 20px">浏览 19</span>
                        <span class="label label-success" style="margin-right: 20px">评论 1</span>
                        <span style="margin-right: 20px"><i class="fa fa-heart" aria-hidden="true"></i>  999</span>
                    </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
	<div class="tab-pane fade" id="comments">
		<p>用于显示所有评论</p>
	</div>
</div>
{% endblock %}